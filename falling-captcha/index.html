<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Mouse Click Falling Captcha</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      background: #0f172a;
      color: #e2e8f0;
      font-family: sans-serif;
      padding: 40px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .form-box {
      background: #1e293b;
      padding: 25px;
      border-radius: 10px;
      width: 350px;
      margin-bottom: 30px;
      border: 1px solid #334155;
    }

    input {
      width: 100%;
      padding: 10px;
      margin-bottom: 15px;
      border-radius: 6px;
      border: 1px solid #475569;
      background: #0f172a;
      color: #e2e8f0;
    }

    button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border-radius: 6px;
      border: none;
      background: #3b82f6;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }

    #canvasBox {
      border: 2px solid #334155;
      border-radius: 10px;
      overflow: hidden;
      margin-top: 10px;
    }

    .status {
      margin-top: 10px;
      text-align: center;
      font-size: 16px;
    }
  </style>
</head>

<body>

  <div class="form-box">
    <h3>Mouse Click Falling CAPTCHA</h3>

    <input placeholder="Email" />
    <input placeholder="Şifre" type="password" />

    <div id="canvasBox">
      <canvas id="captchaCanvas" width="300" height="200"></canvas>
    </div>

    <div id="status" class="status">Aşağı düşen doğru harfe tıkla</div>

    <button id="loginBtn" disabled>Giriş Yap</button>
  </div>

  <script>
    const canvas = document.getElementById("captchaCanvas");
    const ctx = canvas.getContext("2d");

    const statusEl = document.getElementById("status");
    const loginBtn = document.getElementById("loginBtn");

    // Captcha harfi
    const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
    const targetLetter = letters[Math.floor(Math.random() * letters.length)];

    let falling = {
      x: Math.random() * 250 + 25,
      y: -20,
      letter: targetLetter,
      speed: 2 + Math.random() * 2
    };

    let verified = false;

    function draw() {
      ctx.fillStyle = "black";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // harf
      ctx.fillStyle = "#38bdf8";
      ctx.font = "32px Arial";
      ctx.fillText(falling.letter, falling.x, falling.y);

      falling.y += falling.speed;

      // reset – aşağı düşerse yeniden deneme
      if (falling.y > 220 && !verified) {
        falling.x = Math.random() * 250 + 25;
        falling.y = -20;
      }

      if (!verified) requestAnimationFrame(draw);
    }

    draw();

    // Mouse click detection
    canvas.addEventListener("click", (e) => {
      if (verified) return;

      const rect = canvas.getBoundingClientRect();
      const px = e.clientX - rect.left;
      const py = e.clientY - rect.top;

      // Harfin bounding box'ı
      const hitX = px > falling.x - 10 && px < falling.x + 30;
      const hitY = py > falling.y - 30 && py < falling.y + 10;

      if (hitX && hitY) {
        verified = true;
        statusEl.innerHTML = "Doğru harfe tıkladın ✔";
        statusEl.style.color = "#22c55e";
        loginBtn.disabled = false;
      } else {
        statusEl.innerHTML = "Yanlış yere tıkladın ✖";
        statusEl.style.color = "#ef4444";
      }
    });
  </script>

</body>
</html>
