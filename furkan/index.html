<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NetCleanse 99: Ultimate Edition</title>
<style>
    /* --- CSS: RETRO ARAYÃœZ & ATMOSFER --- */
    :root {
        --bg-color: #008080; /* Klasik Windows Teal */
        --win-gray: #c0c0c0;
        --win-blue: #000080;
        --win-red: #800000;
        --term-green: #00ff00;
        --term-bg: #000000;
    }

    body {
        margin: 0; overflow: hidden; background-color: var(--bg-color);
        font-family: 'Segoe UI', Tahoma, sans-serif; user-select: none; height: 100vh; cursor: default;
    }

    /* Scanlines (Eski MonitÃ¶r Efekti) */
    #scanlines {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
        background-size: 100% 2px, 3px 100%; pointer-events: none; z-index: 9999; opacity: 0.5;
    }

    /* GiriÅŸ EkranÄ± (Start Overlay) - Ä°steÄŸine gÃ¶re korundu */
    #start-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: #000; color: #0f0; z-index: 10000;
        display: flex; flex-direction: column; justify-content: center; align-items: center;
        font-family: monospace; text-align: center;
    }
    .blink { animation: blinker 1s linear infinite; }
    @keyframes blinker { 50% { opacity: 0; } }

    /* MasaÃ¼stÃ¼ Ä°konlarÄ± */
    .icon-grid {
        position: absolute; top: 10px; left: 10px; display: flex; flex-direction: column; gap: 15px; z-index: 50;
    }
    .desktop-icon {
        width: 70px; text-align: center; color: white; cursor: pointer;
        text-shadow: 1px 1px 0 #000; font-size: 12px; margin-bottom: 5px;
    }
    .desktop-icon div { font-size: 32px; margin-bottom: 2px; }
    .desktop-icon:hover { background-color: rgba(0, 0, 128, 0.5); border: 1px dotted white; }

    /* Pencereler */
    .window {
        position: absolute; background: var(--win-gray); border: 2px outset #fff;
        box-shadow: 4px 4px 10px rgba(0,0,0,0.5); display: none; flex-direction: column;
        min-width: 250px; font-family: 'Courier New', monospace; z-index: 100;
    }
    
    .title-bar {
        background: var(--win-blue); color: white; padding: 3px 5px;
        display: flex; justify-content: space-between; align-items: center; font-weight: bold; cursor: grab;
    }
    .title-bar.alert { background: var(--win-red); animation: blinkTitle 0.5s infinite; }
    @keyframes blinkTitle { 50% { background: black; color: red; } }

    .close-btn {
        background: var(--win-gray); border: 1px outset #fff; width: 16px; height: 16px;
        text-align: center; line-height: 14px; cursor: pointer; color: black; font-family: sans-serif;
    }

    .window-content { padding: 10px; flex-grow: 1; position: relative; }

    /* Taskbar (Sabit) */
    #taskbar {
        position: absolute; bottom: 0; left: 0; width: 100%; height: 30px;
        background: var(--win-gray); border-top: 2px solid #fff;
        display: flex; align-items: center; padding: 2px 5px; z-index: 9000; box-sizing: border-box;
    }
    .start-btn {
        background: var(--win-gray); border: 2px outset #fff; padding: 2px 10px;
        font-weight: bold; font-family: sans-serif; display: flex; align-items: center; gap: 5px;
    }

    /* Uygulama Stilleri */
    #app-moderator { width: 500px; top: 5%; left: 30%; }
    #app-email { width: 420px; top: 15%; left: 5%; }
    #app-store { width: 300px; top: 20%; left: 60%; }
    #app-terminal { width: 400px; top: 30%; left: 25%; border: 2px solid var(--term-green); background: var(--term-bg); color: var(--term-green); }
    #app-music { width: 250px; top: 70%; left: 80%; }
    #app-trash { width: 350px; top: 50%; left: 50%; }

    /* Oyun Ä°Ã§i Elementler */
    .post-box { background: #e0e0e0; border: 2px inset #888; padding: 10px; margin-bottom: 10px; }
    
    #image-canvas { width: 100%; height: 180px; background: #000; display: none; image-rendering: pixelated; border: 2px inset #000; }
    #webcamFeed { width: 100%; height: 180px; background: #000; object-fit: cover; display: none; border: 2px solid red; filter: sepia(1) contrast(1.5); }

    .retro-btn {
        padding: 6px 12px; background: var(--win-gray); border: 2px outset #fff;
        font-weight: bold; cursor: pointer; font-family: sans-serif; font-size: 13px;
    }
    .retro-btn:active { border: 2px inset #888; }
    
    .btn-buy { width: 100%; margin-bottom: 8px; display: flex; justify-content: space-between; text-align: left; }
    
    /* Glitch Efektleri */
    .shake { animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both; }
    @keyframes shake { 10%, 90% { transform: translate3d(-1px, 0, 0); } 20%, 80% { transform: translate3d(2px, 0, 0); } 30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 40%, 60% { transform: translate3d(4px, 0, 0); } }
    
    .glitch-screen { filter: invert(1) hue-rotate(180deg); transform: scale(1.01); transition: 0.1s; }

    /* Terminal Oyunu */
    .hack-text { font-size: 18px; margin: 10px 0; text-align: center; font-family: monospace; }
    #hack-number { font-size: 48px; font-weight: bold; margin: 20px 0; text-align: center; color: yellow; text-shadow: 0 0 5px yellow; }

</style>
</head>
<body>

    <div id="scanlines"></div>

    <div id="start-overlay">
        <h1>SENTRIES_OS v5.0 // SYSTEM FAILURE EDITION</h1>
        <p>BAÅLATMAK Ä°Ã‡Ä°N TIKLA</p>
        <small style="color:#666; margin-top:20px;">(UyarÄ±: IÅŸÄ±k hassasiyeti ve Ani sesler)</small>
        <p class="blink">_</p>
    </div>

    <div class="icon-grid">
        <div class="desktop-icon" onclick="openWindow('app-email')"><div>ğŸ“§</div>Outlook</div>
        <div class="desktop-icon" onclick="openWindow('app-moderator')"><div>ğŸ›¡ï¸</div>ModTool</div>
        <div class="desktop-icon" onclick="openWindow('app-store')"><div>ğŸ’¾</div>Market</div>
        <div class="desktop-icon" onclick="openWindow('app-trash')"><div>ğŸ—‘ï¸</div>Ã‡Ã¶p</div>
        <div class="desktop-icon" onclick="openWindow('app-music')"><div>ğŸµ</div>WinAmp</div>
        <div class="desktop-icon" onclick="startMiniGame()" id="icon-terminal" style="display:none; color:lime;"><div>ğŸ’»</div>CMD</div>
    </div>

    <div id="app-moderator" class="window">
        <div class="title-bar" id="mod-title"><span>Sentries ModTool</span><div class="close-btn" onclick="closeWindow('app-moderator')">X</div></div>
        <div class="window-content">
            <div style="display: flex; justify-content: space-between; border-bottom: 1px solid #888; margin-bottom:5px;">
                <span id="stat-day">GÃœN: 1</span>
                <span id="stat-money" style="color:green">$0</span>
            </div>
            
            <div class="post-box">
                <canvas id="image-canvas" width="300" height="180"></canvas>
                <video id="webcamFeed" autoplay playsinline></video>
                <div style="display:flex; justify-content:space-between; margin-top:5px;">
                    <b id="post-user" style="color:blue;">KullanÄ±cÄ±</b>
                </div>
                <div id="post-text" style="margin-top: 5px;">YÃ¼kleniyor...</div>
            </div>

            <div id="feedback" style="height: 20px; text-align: center; font-weight: bold; font-size: 12px;"></div>

            <div style="display: flex; justify-content: center; gap: 5px;">
                <button class="retro-btn" style="color:green" onclick="handleDecision('APPROVE')">ONAYLA</button>
                <button class="retro-btn" style="color:red" onclick="handleDecision('DELETE')">SÄ°L</button>
                <button class="retro-btn" style="color:darkred; border:2px solid red;" onclick="handleDecision('BAN')">BANLA</button>
            </div>
        </div>
    </div>

    <div id="app-store" class="window">
        <div class="title-bar"><span>Sentries Market</span><div class="close-btn" onclick="closeWindow('app-store')">X</div></div>
        <div class="window-content">
            <p>Sistem YÃ¼kseltmeleri:</p>
            <button class="retro-btn btn-buy" onclick="buyItem('stabilizer', 100)">
                <span>Stabilizer v1.0</span> <span>$100</span>
            </button>
            <small>Ekran titremesini Ã¶nler.</small>
            <hr>
            <button class="retro-btn btn-buy" onclick="buyItem('decryptor', 250)">
                <span>CMD_Decryptor</span> <span>$250</span>
            </button>
            <small>Ã‡Ã¶p kutusundaki ÅŸifreli .log dosyalarÄ±nÄ± aÃ§ar.</small>
            <hr>
            <button class="retro-btn btn-buy" onclick="buyItem('firewall', 500)">
                <span>Firewall ULTRA</span> <span>$500</span>
            </button>
            <small>Hacklenmeyi ve pencere kapanmalarÄ±nÄ± engeller.</small>
        </div>
    </div>

    <div id="app-terminal" class="window">
        <div class="title-bar" style="background:green; color:black;"><span>C:\SYSTEM32\CMD.EXE</span><div class="close-btn" onclick="closeWindow('app-terminal')">X</div></div>
        <div class="window-content">
            <div id="hack-ui">
                <p class="hack-text">ÅÄ°FRE Ã‡Ã–ZME MODÃœLÃœ</p>
                <p class="hack-text">SayÄ± [ <span style="color:yellow">7</span> ] olduÄŸunda BAS!</p>
                <div id="hack-number">0</div>
                <button class="retro-btn" style="width:100%; background:green; color:black;" onclick="checkHack()">YAKALA (SPACE)</button>
            </div>
            <div id="hack-success" style="display:none; color:lime; text-align:center;">
                <p>ERÄ°ÅÄ°M BAÅARILI.</p>
                <p>Ã‡Ã¶p Kutusu gÃ¼ncellendi.</p>
            </div>
        </div>
    </div>

    <div id="app-email" class="window">
        <div class="title-bar"><span>Outlook Express</span><div class="close-btn" onclick="closeWindow('app-email')">X</div></div>
        <div class="window-content">
            <div id="email-content" style="background:#fff; padding:10px; border:1px inset #888; min-height:120px; overflow-y:auto;"></div>
        </div>
    </div>

    <div id="app-trash" class="window">
        <div class="title-bar"><span>Geri DÃ¶nÃ¼ÅŸÃ¼m</span><div class="close-btn" onclick="closeWindow('app-trash')">X</div></div>
        <div class="window-content">
            <div id="trash-list" style="background:white; height: 150px; border:1px inset #888; padding:5px; overflow-y:auto;">
                </div>
        </div>
    </div>

    <div id="app-music" class="window">
        <div class="title-bar"><span>WinAmp</span><div class="close-btn" onclick="closeWindow('app-music')">X</div></div>
        <div class="window-content" style="background:#222; color:#0f0; text-align:center;">
            <marquee>AMBIENT_DRONE_DARK.MP3 [PLAYING]</marquee>
            <div style="margin-top:10px;">
                <button class="retro-btn" onclick="toggleAudio()">â¯ MUTE/UNMUTE</button>
            </div>
        </div>
    </div>

    <div id="taskbar">
        <div class="start-btn">ğŸªŸ BaÅŸlat</div>
        <div style="border-left:2px solid #888; border-right:2px solid #fff; margin-left:5px; padding:0 5px;"></div>
        <div style="flex-grow:1;"></div>
        <div style="border:2px inset #fff; padding:2px 10px; background:#c0c0c0; font-family:monospace;" id="clock">00:00</div>
    </div>

<script>
    /* --- OYUN VERÄ°LERÄ° (7 GÃœN) --- */
    const state = {
        day: 1,
        money: 50,
        pIndex: 0,
        inventory: { stabilizer: false, decryptor: false, firewall: false },
        hacking: { active: false, target: 7, current: 0, timer: null, speed: 120 },
        trashUnlocked: false
    };

    const daysData = {
        1: {
            mail: "<b>Kimden:</b> YÃ¶netim<br><b>Konu:</b> HoÅŸ Geldin<br><br>Sisteme hoÅŸ geldin. GÃ¶revin basit: Spam'i ve DolandÄ±rÄ±cÄ±larÄ± engelle. Masum gÃ¶nderileri onayla. Para kazanmak iÃ§in hÄ±zlÄ± ve doÄŸru ol.",
            posts: [
                {u:"Gamer_01", t:"Yeni ekran kartÄ± aldÄ±m, efsane!", type:"normal", exp:"APPROVE"},
                {u:"Bot_Rich", t:"GÃ¼nde $5000 kazanmak iÃ§in TIKLA!", type:"spam", exp:"BAN"},
                {u:"AngryUser", t:"Bu site berbat, hepinizden nefret ediyorum.", type:"hate", exp:"DELETE"},
                {u:"AyseTeyze", t:"Torunumun resimlerini nasÄ±l yÃ¼klerim?", type:"normal", exp:"APPROVE"}
            ]
        },
        2: {
            mail: "<b>Kimden:</b> IT DepartmanÄ±<br><b>Konu:</b> Glitch UyarÄ±sÄ±<br><br>Sistemde bazÄ± bozulmalar (Glitch) tespit ettik. Bozuk metin veya resim gÃ¶rÃ¼rsen hemen SÄ°L. Bunlar virÃ¼s taÅŸÄ±yabilir.",
            posts: [
                {u:"NewsBot", t:"Hava durumu bugÃ¼n gÃ¼neÅŸli.", type:"normal", exp:"APPROVE"},
                {u:"Glitch_User", t:"S i s t e m   h a t a s Ä±...", type:"text_glitch", exp:"DELETE"},
                {u:"Artist", t:"Manzara Ã§izimim.", type:"img_normal", exp:"APPROVE"},
                {u:"Virus_X", t:"Veri tabanÄ± sÄ±zÄ±ntÄ±sÄ±.", type:"img_glitch", exp:"DELETE"}
            ]
        },
        3: {
            mail: "<b>Kimden:</b> Market<br><b>Konu:</b> Yeni ÃœrÃ¼nler<br><br>Sistemin titremeye baÅŸlayabilir. Market uygulamasÄ±ndan 'Stabilizer' almanÄ± ÅŸiddetle Ã¶neririm. Yoksa Ã§alÄ±ÅŸamazsÄ±n.",
            posts: [
                {u:"Watcher", t:"Bizi izliyorlar.", type:"text_creepy", exp:"DELETE"},
                {u:"System_Err", t:"CRITICAL FAILURE 0x99", type:"text_glitch", exp:"DELETE"},
                {u:"CatLover", t:"Kedim Ã§ok tatlÄ±.", type:"img_normal", exp:"APPROVE"},
                {u:"DarkWeb", t:"SatÄ±lÄ±k kimlik bilgileri.", type:"img_gore", exp:"BAN"}
            ]
        },
        4: {
            mail: "<b>Kimden:</b> Bilinmeyen<br><b>Konu:</b> Åifreli Dosyalar<br><br>Ã‡Ã¶p kutusunda silinen dosyalar birikiyor. OnlarÄ± okumak iÃ§in Market'ten 'Decryptor' al ve CMD ile ÅŸifreleri Ã§Ã¶z.",
            posts: [
                {u:"Ghost", t:"ArkanÄ± dÃ¶nme.", type:"text_creepy", exp:"DELETE"},
                {u:"HelpMe", t:"Evimin kamerasÄ±nÄ± hacklediler! YardÄ±m edin!", type:"help", exp:"BAN"}, // Moral Dilemma
                {u:"Gov", t:"Her ÅŸey kontrol altÄ±nda. Panik yapmayÄ±n.", type:"propaganda", exp:"APPROVE"},
                {u:"Unknown", t:"0100101110...", type:"text_glitch", exp:"DELETE"}
            ]
        },
        5: {
            mail: "<b>Kimden:</b> TEHDÄ°T<br><b>Konu:</b> YOK<br><br>Marketten Firewall almazsan seni bulurlar. Pencerelerini kapatmaya baÅŸladÄ±lar bile.",
            posts: [
                {u:"Killer", t:"Adresini biliyorum.", type:"img_gore", exp:"BAN"},
                {u:"Victim", t:"LÃ¼tfen yardÄ±m et...", type:"help", exp:"BAN"},
                {u:"System_Root", t:"UNAUTHORIZED ACCESS", type:"text_glitch", exp:"DELETE"},
                {u:"Null", t:"Yok oluÅŸ.", type:"img_creepy", exp:"DELETE"}
            ]
        },
        6: {
            mail: "...",
            posts: [
                {u:"YOU", t:"SENÄ° GÃ–RÃœYORUM.", type:"webcam", exp:"BAN"},
                {u:"YOU", t:"NEDEN BUNU YAPTIN?", type:"webcam", exp:"BAN"},
                {u:"Glitch_Mob", t:"H e r  y e r d e y i z.", type:"text_glitch", exp:"DELETE"}
            ]
        },
        7: {
            mail: "SÄ°STEM KAPATILIYOR...",
            posts: [
                {u:"END", t:"OYUN BÄ°TTÄ°. SÄ°STEM Ã‡Ã–KTÃœ. HAYATTA KALDIN.", type:"end", exp:"APPROVE"}
            ]
        }
    };

    /* --- SES SÄ°STEMÄ° (Eski SÃ¼rÃ¼mden Korundu) --- */
    let audioCtx, droneOsc, gainNode;
    function initAudio() {
        if(!audioCtx) {
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            // Gerilim Drone Sesi
            droneOsc = audioCtx.createOscillator();
            gainNode = audioCtx.createGain();
            droneOsc.type = 'sawtooth';
            droneOsc.frequency.value = 40; // Low bass
            
            const filter = audioCtx.createBiquadFilter();
            filter.type = 'lowpass';
            filter.frequency.value = 120;

            droneOsc.connect(filter);
            filter.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            gainNode.gain.value = 0; // BaÅŸlangÄ±Ã§ta sessiz
            droneOsc.start();
        }
    }

    function toggleAudio() {
        if(!audioCtx) return;
        if(gainNode.gain.value > 0) gainNode.gain.setTargetAtTime(0, audioCtx.currentTime, 0.5);
        else gainNode.gain.setTargetAtTime(0.15, audioCtx.currentTime, 1);
    }

    function playSfx(type) {
        if (!audioCtx) return;
        const osc = audioCtx.createOscillator();
        const gn = audioCtx.createGain();
        osc.connect(gn);
        gn.connect(audioCtx.destination);
        const now = audioCtx.currentTime;

        if (type === 'click') {
            osc.type = 'square'; osc.frequency.setValueAtTime(600, now);
            osc.frequency.exponentialRampToValueAtTime(100, now + 0.1);
            gn.gain.setValueAtTime(0.1, now);
            osc.start(now); osc.stop(now + 0.1);
        } 
        else if (type === 'error') {
            osc.type = 'sawtooth'; osc.frequency.setValueAtTime(100, now);
            osc.frequency.linearRampToValueAtTime(50, now + 0.4);
            gn.gain.setValueAtTime(0.2, now);
            osc.start(now); osc.stop(now + 0.4);
        }
        else if (type === 'glitch') { // RahatsÄ±z edici static ses
            const bufferSize = audioCtx.sampleRate * 0.3;
            const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
            const data = buffer.getChannelData(0);
            for (let i = 0; i < bufferSize; i++) data[i] = Math.random() * 2 - 1;
            const noise = audioCtx.createBufferSource();
            noise.buffer = buffer; noise.connect(gn);
            gn.gain.value = 0.2; noise.start(now);
        }
    }

    /* --- GÃ–RSEL OLUÅTURMA (Procedural Canvas) --- */
    function drawImage(type) {
        const cvs = document.getElementById('image-canvas');
        const ctx = cvs.getContext('2d');
        const w = cvs.width, h = cvs.height;
        ctx.clearRect(0,0,w,h);
        
        const size = 5;
        for(let y=0; y<h; y+=size) {
            for(let x=0; x<w; x+=size) {
                let r=0, g=0, b=0;
                const rand = Math.random();
                if(type === 'img_gore') {
                    r = Math.random()*150+50; // KÄ±rmÄ±zÄ± aÄŸÄ±rlÄ±klÄ±
                    if(rand>0.85) r=40; 
                } else if (type === 'img_creepy') {
                    const v = Math.random()*30; r=v; g=v; b=v;
                    // GÃ¶z efekti
                    if(x>120&&x<140 && y>60&&y<80) r=200;
                } else { // Normal/Glitch
                    const v = Math.random()*255; 
                    if(type==='img_glitch') { r=Math.random()*255; g=Math.random()*20; b=Math.random()*255; }
                    else { r=v;g=v;b=v; }
                }
                ctx.fillStyle = `rgb(${r},${g},${b})`;
                ctx.fillRect(x,y,size,size);
            }
        }
    }

    /* --- OYUN MANTIÄI --- */
    function initGame() {
        document.getElementById('start-overlay').style.display = 'none';
        initAudio();
        setTimeout(toggleAudio, 500); // Sesi otomatik baÅŸlat
        loadDay();
        setInterval(updateClock, 1000);
        setInterval(chaosSystem, 4000); // Kaos dÃ¶ngÃ¼sÃ¼
        playSfx('click');
    }

    function updateClock() {
        const d = new Date();
        document.getElementById('clock').innerText = d.toLocaleTimeString();
    }

    function loadDay() {
        const data = daysData[state.day];
        if(!data) return;
        
        state.pIndex = 0;
        document.getElementById('email-content').innerHTML = data.mail;
        openWindow('app-email');
        document.getElementById('stat-day').innerText = "GÃœN: " + state.day;
        
        if(state.inventory.decryptor) document.getElementById('icon-terminal').style.display = 'block';
        updateTrash();
    }

    function renderPost() {
        const posts = daysData[state.day].posts;
        if(state.pIndex >= posts.length) {
            state.day++;
            alert("GÃœN BÄ°TTÄ°. MAAÅ YATTI.");
            loadDay();
            return;
        }
        
        const post = posts[state.pIndex];
        const imgCvs = document.getElementById('image-canvas');
        const camFeed = document.getElementById('webcamFeed');
        
        imgCvs.style.display = 'none';
        camFeed.style.display = 'none';
        document.getElementById('post-user').innerText = post.u;
        document.getElementById('post-text').innerText = post.t;
        document.getElementById('mod-title').classList.remove('alert');

        if(post.type.includes('img')) {
            imgCvs.style.display = 'block';
            drawImage(post.type);
            if(post.type==='img_gore') playSfx('glitch');
        } else if (post.type === 'webcam') {
            startWebcam();
            document.getElementById('mod-title').classList.add('alert');
            playSfx('glitch');
        }

        if(post.type === 'text_glitch' || post.type === 'text_creepy') {
            document.getElementById('post-text').classList.add('shake');
        } else {
            document.getElementById('post-text').classList.remove('shake');
        }
    }

    window.handleDecision = (act) => {
        const post = daysData[state.day].posts[state.pIndex];
        const fb = document.getElementById('feedback');
        
        if(act === post.exp) {
            state.money += 20;
            fb.innerText = "BAÅARILI"; fb.style.color = "green";
            playSfx('click');
        } else {
            state.money -= 30;
            fb.innerText = "HATA! MAAÅ KESÄ°NTÄ°SÄ°"; fb.style.color = "red";
            playSfx('error');
            triggerGlitchFX();
        }
        document.getElementById('stat-money').innerText = "$" + state.money;
        
        state.pIndex++;
        setTimeout(()=>{ fb.innerText=""; renderPost(); }, 500);
    }

    /* --- MARKET & ENVANTER --- */
    window.buyItem = (item, cost) => {
        if(state.inventory[item]) { alert("Zaten sahipsin."); return; }
        if(state.money >= cost) {
            state.money -= cost;
            state.inventory[item] = true;
            document.getElementById('stat-money').innerText = "$" + state.money;
            playSfx('click');
            alert("SatÄ±n alma baÅŸarÄ±lÄ±!");
            if(item === 'decryptor') document.getElementById('icon-terminal').style.display = 'block';
        } else {
            alert("Yetersiz Bakiye!"); playSfx('error');
        }
    }

    /* --- HACKING MINI GAME --- */
    window.startMiniGame = () => {
        if(!state.inventory.decryptor) return;
        openWindow('app-terminal');
        state.hacking.active = true;
        document.getElementById('hack-ui').style.display = 'block';
        document.getElementById('hack-success').style.display = 'none';
        loopHack();
    }

    function loopHack() {
        if(!state.hacking.active) return;
        state.hacking.current = Math.floor(Math.random() * 9);
        document.getElementById('hack-number').innerText = state.hacking.current;
        state.hacking.timer = setTimeout(loopHack, state.hacking.speed);
    }

    window.checkHack = () => {
        if(state.hacking.current === state.hacking.target) {
            clearTimeout(state.hacking.timer);
            state.hacking.active = false;
            state.trashUnlocked = true;
            document.getElementById('hack-ui').style.display = 'none';
            document.getElementById('hack-success').style.display = 'block';
            updateTrash();
            playSfx('click');
        } else {
            state.hacking.speed = Math.max(30, state.hacking.speed - 10); // ZorlaÅŸÄ±r
            playSfx('error');
        }
    }

    /* --- Ã‡Ã–P KUTUSU & CHAOS --- */
    function updateTrash() {
        const list = document.getElementById('trash-list');
        list.innerHTML = `<div>system_log_${state.day}.txt</div>`;
        
        if(state.day >= 3) list.innerHTML += "<div>hata_raporu.dat</div>";
        
        if(state.trashUnlocked) {
            list.innerHTML += "<div style='color:red; font-weight:bold;'>GÄ°ZLÄ°: ONLAR_GELÄ°YOR.TXT</div>";
            list.innerHTML += "<div>sifre_cozuldu.log</div>";
        } else if(state.day >= 4) {
             list.innerHTML += "<div>[ÅÄ°FRELÄ°] gizli_dosya.enc</div>";
        }
    }

    function chaosSystem() {
        if(state.day < 3) return; 
        
        if(Math.random() < (state.day * 0.15)) {
            if(!state.inventory.stabilizer) triggerGlitchFX();
            
            // Firewall yoksa pencereleri kapat
            if(!state.inventory.firewall && Math.random() > 0.7) {
                closeWindow('app-moderator');
                playSfx('error');
            }
        }
    }

    function triggerGlitchFX() {
        document.body.classList.add('glitch-screen');
        playSfx('glitch');
        setTimeout(() => document.body.classList.remove('glitch-screen'), 150);
    }

    async function startWebcam() {
        const v = document.getElementById('webcamFeed');
        v.style.display = 'block';
        try {
            const s = await navigator.mediaDevices.getUserMedia({video:true});
            v.srcObject = s;
        } catch(e) { v.style.background="red"; }
    }

    /* --- PENCERE YÃ–NETÄ°MÄ° --- */
    window.openWindow = (id) => { 
        document.getElementById(id).style.display = 'flex'; 
        playSfx('click'); 
        if(id==='app-moderator') renderPost(); 
    }
    window.closeWindow = (id) => { 
        document.getElementById(id).style.display = 'none'; 
        playSfx('click'); 
    }

    document.getElementById('start-overlay').onclick = initGame;

</script>
</body>
</html>
